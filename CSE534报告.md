

# I. 导言 

这是 2019 年秋季学期选修的应用密码学（CSE539）课程的作品集报告。在这门课程中，我们必须完成 6 个项目/作业，每个项目/作业都要求我们使用常规课堂上讲授的主题和概念。
在项目1中，我们需要创建一个新的/修改后的算法，并使用C、C++或Java实现该算法，使用S-box（替换）和P-box（置换）对32比特的明文数据块（txt、pdf或jpeg格式）进行加密和解密，从而掩盖明文和密码之间的关系，并使用蛮力技术尝试找出用于进行转换的密钥，前提是我们知道明文和密码。我们还被要求记录蛮力技术找到密钥所需的时间，并评论所用时间与文件类型之间是否存在任何关系，以及任何可能导致更快破解加密的弱点。
在项目 2 中，我们得到了用 C 语言编写的文件加密和解密代码，我们要对加密算法的设计、它是否是一个自足的算法进行评论，并在只知道文件类型（jpg、pdf、txt）的情况下，使用两种不同的技术（蛮力和密码分析）来找出加密过程中使用的密钥、 pdf、txt）的情况下，找出解密过程中使用的密钥，报告加密过程中的不足之处，可以采取哪些措施来解决，并记录两种技术的运行时间以进行比较。
在项目 3 中，我们获得了 10 个哈希值，我们必须为这些哈希值获取密码，前提是密码未加密、为字母数字且长度为 4 个字符。我们被要求使用两种黑客常用的方法来破解密码哈希值，即暴力破解和彩虹表攻击。我们要为上述两种技术分别编写一个程序，记录它们的运行时间，并对创建彩虹表所涉及的实现步骤、大小、所使用的还原函数以及破解哈希值所用方法中的任何不足之处发表评论。
项目 4 要求我们使用项目 2 中的加密算法和项目 3 中的散列算法创建 MAC（消息验证码），用于维护消息的完整性和真实性。如果入侵者试图修改信息，整个数据的哈希值就会发生变化，接收者就能知道数据的真假，因为发送的哈希值和使用 MAC 计算的哈希值并不相似。我们要编写的是 C 语言程序，命令行需要两个输入，即包含信息的文件路径和用于加密的密钥。
在项目 5 中，我们使用由 CA（证书颁发机构）颁发的数字证书。使用 Python3 的密码学库，我们必须获取主体的公钥和模数，以便双方进行安全通信；验证主体的证书是否有效；从根证书和主体的证书中提取主体名称、序列号、加密算法、公钥模数、公钥指数、私钥指数等信息。最后，我们必须使用主体证书中的公钥加密信息，并使用主体的私钥解密验证。
在最后一个项目中，我们开发了一个 CPP 程序来实现挑战响应方案，该方案用于验证被挑战方是否知道特定挑战的正确答案；通过向构造函数提供参数来测试给定的 RSA 类；以及盲签名，即发送方从接收方处获取文件签名，而不透露他们的身份。我们提供了执行上述每种技术的步骤。



# II. 解决方案的解释
A. 项目 1
在加密部分，我们修改了 Vigenere 密码，这是一个多字母替换系统，使用一个密钥和一个双输入表，我们的密码不使用字母，而是使用十六进制字符，这样就减少了输入表的大小。然后，我们通过重复使用密钥，使密钥和信息长度相同，直到两者长度相同为止。在经过明文和密钥相加并按字符取模 16 的置换循环后，中间密码要经过 3 个不同的 P-Box，以使密码更加模糊，并使找到密码和明文之间的规律变得困难。
解密时，我们将密码通过 3 个 P-Box，然后通过改进的维基解密，将密钥值和密码值相减，再按字符取模，最后得到明文。
提出算法后，我们将其逻辑转化为 CPP 语言程序，用于加密和解密。在暴力破解部分，我们修改了解密代码，由于我们知道明文和密文，所以一开始密钥为 0x00，然后以 1 为单位递增，直到解密结果和明文的值不一样为止。
B. 项目 2
我们对加密程序代码进行了密码分析，仔细研究了其中的每一个步骤，了解它们的目的是什么，以及它们是如何将明文和密钥转化为密文的。我们还分析了所提供的 MD5（消息加密）代码的工作，以了解其目的。在分析过程中，我们发现它并不是一个自包含的代码，它 “作弊 ”不使用 MD5 来加密明文。
为了进行暴力破解，我们修改了解密代码，从密钥值为 0x00 开始，将密钥值递增 1，直到密文前 4 个字符与密钥的 XOR 值没有产生与我们试图找到的解密版本相匹配的特定要求的十六进制文件签名。对于加密分析的结果，我们只需创建一个程序，在密文的前 4 个字符和特定的十六进制文件签名之间进行 XOR 运算，就能得到所需的密钥值。
C. 项目 3
我们首先生成所有 32 位长的字母数字密码，并将其存储在一个文件中。为了进行暴力破解，我们读取了包含密码的文件，逐个读取每个密码，使用项目说明中已经给出的哈希函数，将其与给出的哈希值进行比较，并打印出找到匹配的密码。
对于彩虹表，我们选择的表大小为 62 * 238328，也就是说，我们选择了 62 个不同的密码，使用散列和还原函数运行了 238328 次链过程，然后将结果散列和密码存储在一个文件中。然后，我们将给出的哈希值逐一提取，使用还原函数和哈希函数，最多运行 238328 次，直到生成的中间哈希值与我们存储的 62 个哈希值中的任何一个都不匹配为止。一旦找到匹配值，就会提取存储的密码，然后进行链式处理，直到找不到给定的哈希值为止，这样得到的哈希值就是我们想要的结果。
D. 项目 4
为了创建预期的 mac.c 文件，正如描述中提到的，我们首先从命令行接收 1024 字节文件的路径和密钥作为参数。   

 首先，我们使用项目 2 中的加密函数和 32 位长密钥对给定的 1024 字节文件数据进行加密，得到一个 1028 字节的结果，然后删除前 4 个字节并将其与密钥集中在一起，并使用项目 3 中的哈希函数对集中值进行哈希计算，得到结果 MAC。
E. 项目 5
为了创建 Python 文件，我们创建了一些函数，以便从给定的主体和根证书中收集和显示各种询问信息以及主体的私钥。我们使用了 Python3 加密库，如 load_certificate、get_signature_algorithm()、get_notAfter()、get_notBefore()、load_pem_public_key、dump_publickey 等，以获取询问信息。 我们还使用 encrypt() 对信息进行了加密，并使用 decrypt() 函数对密码进行了解密。
F. 项目 6
在 CPP 文件中，我们按照 RSA 的说明创建了项目提供的 RSA 类实例，通过向构造函数提供 0 或 1 或 2 个参数来检查加密和解密函数，并通过向构造函数提供非质数作为参数来检查它是否只适用于质数。
对于 “挑战-回应 ”方案，我们创建了两个 RSA 类实例，并将其中一个实例的公钥和模数分配给另一个实例。生成随机信息，使用公钥加密，使用私钥解密，并检查随机数和解密值是否相似。
对于盲签名，我们按照项目说明中给出的步骤，创建了 RSA 类的实例 Alice 和 Bob，他们相互通信，Alic 发送信息让 Bob 签名，而 Bob 不知道 Alice 的身份。







# III. 成果说明
A. 项目 1
借助修改后的 vigenere 密码，由于密钥和移位的变化，我们获得了相同字符的不同值，使其能够抵御基于频率分析的攻击，同时借助 3 PBox，我们缓解了密钥长度预测的问题，并使密码与纯文本相比尽可能模糊。
在蛮力攻击中，我们发现文件类型与算法之间没有任何关系，所有 3 种类型的文件在蛮力攻击中花费的时间相同。

B. 项目 2
首先，我们发现加密过程并没有使用项目中给出的MD5 算法来处理明文，而是对密钥进行加密，为了生成密文，程序在明文和密钥之间进行了 XOR 处理。
我们发现，通过密码分析所花费的时间远远少于蛮力分析所花费的时间，而且对于不同的文件，有不同的文件签名，这些签名对于解密过程和获得所需的解密文件非常有用，因此每种文件格式获得解密文件所花费的时间都不同。为了消除这一弱点，我们建议对明文而不是密钥进行 MD5 运算，或者使用一种比 XOR 运算产生的结果更复杂的运算。
C. 项目 3
在这个项目中，我们在进行暴力破解时找到了给定哈希值的所有密码，但在彩虹表攻击中，我们没有找到其中 1 个给定哈希值的密码。暴力破解的执行时间几乎是彩虹表时间的 10 倍，而且我们发现，对于较小的密码（本例中为 4 个字符），计算结果的时间不到 2 分钟，因此，密码长度必须大于 6 个字符，这两种攻击才不可行。
D. 项目 4
在这个项目中，我们接收信息的 MAC 值作为结果，它是由包含密钥和加密信息的集中字符串的哈希值形成的。
E. 项目 5
我们使用各种 python3 库验证了主体的证书，并打印了证书的各种数据，如主体名称、签发人、序列号、加密算法、之前无效、之后无效、公钥模数（n）、公钥和私钥指数、十六进制签名。最后，我们使用主体的公钥对信息进行加密。
F. 项目 6
对于盲签名，爱丽丝用公钥对从鲍勃处获得的随机数进行加密，然后与爱丽丝想要签名的信息相乘，并将其发送给鲍勃，鲍勃解密后发送给爱丽丝，爱丽丝将其与随机数的倒数相乘，得到所需的签名信息。





# IV. 我的贡献说明
A. 项目 1
在这个项目中，我负责创建 CPPprogram 和算法，设计用于加密和解密过程的修改过的 vigenerecipher 和 3 Pbox 以及报告编写部分。
B. 项目 2
修改用于获取所需输出密钥的解密代码，撰写报告并记录蛮力分析和密码分析的输出结果，同时建议使用比 XOR 操作产生的结果更模糊的更强算法。
C. 项目 3
我想出了适当的还原函数，这有助于覆盖大部分哈希值，同时修改哈希函数的代码，以便在暴力破解时读取文件，并将计算出的哈希值与给定的哈希值进行比较；在彩虹表攻击时，进行链式处理，找出 62 个存储哈希值中是否有匹配的中间哈希值。
D. 项目 4
创建 C 语言程序，使用项目 2 的加密函数对文件中的数据进行加密，然后将结果字符串和密钥的组合值发送到哈希函数，并获取信息的 MAC。
E. 项目 5
研究项目中需要使用的所有库、其实现示例以及如何使用这些库。创建每个部分需要调用的不同 python 函数，并编写自述，说明如何使用该程序并从中收集必要的信息。
F. 项目 6
创建 CPP 程序，为每个部分创建 RSA 类实例，并创建方法来检查解密函数和明文（随机数）的结果是否相似。创建了用于挑战-响应和盲签名的函数，创建了显示 Alice 和 Bob 之间通信的单独函数。





# V. 学到的新技能
在整个课程和项目执行过程中，我学到了不少新技能和技巧，这些技能和技巧对完成本课程和在实际场景中使用非常有用。

1) 加密和解密过程，其中涉及的步骤
    S-Box 和 P-Box 的使用，使用它们来创建可逆解密程序。
    使用它们来创建可逆解密算法，其目的是
    最后，关于蛮力，考虑到我们知道算法和明文并试图找到密钥，解密所需的时间和精力。
2) 蛮力和密码分析之间的区别
    暴力破解和密码分析技术的区别，为什么暴力破解可能无效，以及
    如何分析代码、密码文本和明文，以找到其中的模式并利用这些模式。
    如何分析代码、密码文本、明文以找出其中的模式，并利用这些模式找出
    找出加密算法中的缺陷和瑕疵、
    并利用这些模式找出加密算法中的缺陷和瑕疵，加以利用，从而获得用于通信的对称密钥。
    用于通信。
3) 彩虹表，这是大多数黑客用来破解密码的技术。
    黑客用来破解密码的技术。学习
    彩虹表的创建和使用以及密钥
    在时间和内存方面的区别
    暴力破解和彩虹表所需时间和内存的关键区别，以及选择正确的还原函数的重要性。
    为彩虹表选择正确的还原函数的重要性
    彩虹表的重要性，以便涵盖最多密码
    及其哈希值。
4) MAC（信息验证码），其重要性、
    它如何通过使用先前学习的信息来帮助维护信息的完整性和真实性
    的完整性和真实性。
    哈希值和加密信息的技术，帮助维护信息的完整性和真实性。
5) Python3 库及其实现，用于验证
    给定根证书和主体证书的数字证书、
    从中提取信息。同时使用
    PKI（公钥基础设施），即使用公钥和私钥来加密和解密信息。
    密钥对信息进行加密和解密。
6) RSA 加密，用于安全传输数据。
    认证技术。以及用于获取个人签名的盲签名。
    用于在某人不知道发送者的情况下获取其签名。
    知道发件人。









# VI. 团队成员
所有项目都是在 2 人小组中完成的，其他小组成员是 Shivank Tiwari。
参考文献
[1] Tutorialspoint.com. 公钥加密 - Tutorialspoint。[online] Available at：
https://www.tutorialspoint.com/cryptography/public_key_encryption.htm
[2] Tutorialspoint.com. 费斯特尔区块密码

- Tutorialspoint. [online] Available at：
https://www.tutorialspoint.com/cryptography/feistel_block_cipher.htm
[3] Pyopenssl.org. Crypto - 通用密码模块 - PyOpenSSL 19.1.0 文档。
pyOpenSSL 19.1.0 文档。[online] Available at：
https://pyopenssl.org/en/stable/api/crypto.html
[4] X.509 Reference. 见： https://cryptography.io/en/latest/x509/reference/
[5] En.wikipedia.org. 盲签名。[online] Available at：
https://en.wikipedia.org/wiki/Blind_signature



